# 엑셀/CSV 파일 자동 프로세싱 프로그램

## 개요
이 프로그램은 사용자가 업로드한 엑셀(.xlsx) 또는 CSV(.csv) 파일을 pandas로 불러와, sample 관련 열을 자동으로 정리하고, Time 열을 추가한 뒤, 원하는 파일명으로 저장할 수 있는 Python 스크립트입니다.

---

## 주요 기능
1. **파일 자동 감지 및 로드**
   - 입력한 경로의 파일이 .xlsx 또는 .csv인지 자동으로 판별하여 불러옵니다.
2. **헤더(열 이름) 공백 자동 제거**
   - 모든 열 이름의 앞뒤 공백을 자동으로 제거합니다.
3. **'sample' 관련 열 자동 처리**
   - 'sample'이 포함된 열 중 첫 번째 열만 남기고 나머지는 자동 삭제합니다.
   - 남겨진 sample 열 이름은 자동으로 인식하여 Time 계산에 사용합니다.
4. **Time 열 자동 추가**
   - sample 열 값에 0.01을 곱한 값을 'Time'이라는 이름의 새 열로, DataFrame의 맨 앞에 추가합니다.
5. **결과 미리보기 및 저장**
   - 처리된 데이터의 처음 5행을 콘솔에 출력합니다.
   - 저장 여부를 y/n(예/아니오)로 물어보고, 파일명을 입력하지 않으면 기존 파일명 뒤에 `_processed`가 붙은 이름으로 같은 폴더에 저장합니다.
   - y/n 외의 입력이 들어오면 안내 메시지와 함께 재입력을 요구합니다.

---

## 설치 방법

1. Python 3.8 이상이 설치되어 있어야 합니다.
2. 필요한 패키지 설치:
   ```bash
   pip install -r requirements.txt
   ```

---

## 사용법

1. 터미널(명령 프롬프트)에서 프로그램이 있는 폴더로 이동합니다.
2. 아래 명령어로 프로그램을 실행합니다:
   ```bash
   python excel_processor.py
   ```
3. 안내에 따라 파일명을 입력합니다. (같은 폴더에 있으면 파일명만 입력)
4. 처리된 데이터의 미리보기가 출력됩니다.
5. 저장 여부를 y/n(예/아니오)로 입력합니다.
   - y/yes/예: 저장 진행
   - n/no/아니오: 저장하지 않음
   - 그 외 입력: "y(예) 또는 n(아니오)로 입력해 주세요." 안내 후 재입력
6. 저장할 파일명을 입력하지 않고 엔터를 누르면, 기존 파일명 뒤에 `_processed`가 붙은 이름으로 같은 폴더에 저장됩니다.

---

## 예시 실행 화면
```
==================================================
엑셀 파일 프로세싱 프로그램
==================================================
처리할 파일 경로를 입력하세요: 05.DOF_ANGLE_CONTROLL_P_d_dot.xlsx
파일이 성공적으로 로드되었습니다: 05.DOF_ANGLE_CONTROLL_P_d_dot.xlsx
데이터 형태: 1000행 x 6열
헤더 정리가 완료되었습니다.
발견된 'sample' 관련 열들: ['sample 수', 'sample 1', 'sample 2']
삭제된 열들: ['sample 1', 'sample 2']
남겨진 'sample' 열: sample 수
'Time' 열이 성공적으로 추가되었습니다.

==================================================
처리된 데이터 (처음 5행)
==================================================
   Time  sample 수  DOF1  DOF2
0  0.00          0   ...   ...
1  0.01          1   ...   ...
2  0.02          2   ...   ...
3  0.03          3   ...   ...
4  0.04          4   ...   ...

처리된 파일을 저장하시겠습니까? (y/n): y
저장할 파일 경로를 입력하세요 (엔터 시 자동 저장):
처리된 파일이 성공적으로 저장되었습니다: 05.DOF_ANGLE_CONTROLL_P_d_dot_processed.xlsx

프로그램이 성공적으로 완료되었습니다!
```

---

## 입력/출력 파일 예시

### 입력 예시
| sample 수 | DOF1 | sample 1 | DOF2 | sample 2 | ... |
|-----------|------|----------|------|----------|-----|
| 0         | ...  | 0        | ...  | 0        | ... |
| 1         | ...  | 1        | ...  | 1        | ... |
| 2         | ...  | 2        | ...  | 2        | ... |

### 출력 예시
| Time  | sample 수 | DOF1 | DOF2 | ... |
|-------|-----------|------|------|-----|
| 0.00  | 0         | ...  | ...  | ... |
| 0.01  | 1         | ...  | ...  | ... |
| 0.02  | 2         | ...  | ...  | ... |

---

## 주의사항 및 팁
- 입력 파일은 반드시 첫 번째 행이 헤더여야 합니다.
- 'sample'을 포함하는 열이 최소 하나 이상 있어야 합니다.
- 파일 경로는 전체 경로(절대 경로) 또는 같은 폴더에 있으면 파일명만 입력해도 됩니다.
- 저장 경로를 입력하지 않으면 자동으로 `_processed`가 붙은 이름으로 같은 폴더에 저장됩니다.
- 폴더에 쓰기 권한이 없으면 저장이 안 될 수 있습니다.
- 파일 탐색기에서 폴더를 새로고침(F5) 해보세요.

---

## 오류 및 예외 처리
- 파일이 존재하지 않거나, 지원하지 않는 파일 형식이면 오류 메시지가 출력됩니다.
- 'sample' 관련 열이 없으면 경고 메시지가 출력됩니다.
- 저장 여부 입력이 잘못되면 안내 후 재입력을 요구합니다.
- 저장 중 오류가 발생하면 오류 메시지가 출력됩니다.

---

## 샘플 데이터 생성 (테스트용)
테스트용 샘플 데이터를 만들고 싶다면 아래 스크립트를 실행하세요:
```bash
python create_sample_data.py
```

---

## 문의 및 개선 요청
추가 기능 요청, 버그 제보 등은 언제든 말씀해 주세요! 