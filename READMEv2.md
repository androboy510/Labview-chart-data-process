# Excel Data Processor (최신 GUI)

## 📋 최신 업데이트 내역 (2025-06-28)

### 🔄 최근 업데이트 (2025-06-28)
- **프로그램 이름 변경**: "Excel Data Processor" → "Labview waveform chart data processor"
  - 메인 창 타이틀과 헤더 텍스트 모두 변경
  - 더욱 명확하고 전문적인 프로그램명으로 개선
- **코드 정리**: 불필요한 최근 파일 관련 코드 및 속성 완전 제거
  - linter 오류 해결 (drop_target_register, dnd_bind, recent_listbox 등)
  - v4에서는 최근 파일 UI/기능 없음으로 코드 최적화

### 🎨 UI/UX 개선 (2025-06-28)
- **미니멀 디자인**: 애플/스타트업 스타일의 모던한 인터페이스
- **불필요한 요소 제거**: 최근 파일 카드, 빠른 액션 카드 등 제거
- **창 최대화**: 프로그램 실행 시 화면 90% 높이로 자동 최대화
- **스크롤 최적화**: 미리보기 영역에만 스크롤 적용, 전체 스크롤 제거
- **팝업/알림음 제거**: 저장 시 팝업 없이 상태바로만 메시지 표시

### ⚡ 고급 기능 (2025-06-28)
- **다중 파일 처리**: 대기열 시스템으로 여러 파일 순차 처리
- **드래그 앤 드롭**: tkinterdnd2 라이브러리로 파일 드래그 앤 드롭 지원
- **빠른 저장 개선**: 원본 파일 폴더에 자동 저장 (작업 폴더가 아닌)
- **진행 바**: 실시간 처리 진행 상황 표시

### 🔧 기술적 개선 (2025-06-28)
- **tkinter 옵션 수정**: `-initialvalue` → `initialfile` 오류 해결
- **스레드 처리**: 백그라운드에서 파일 처리하여 UI 응답성 향상
- **오류 처리**: 드래그 앤 드롭 미지원 환경에서 안내 메시지 표시
- **실행 파일**: pyinstaller로 .exe 파일 생성 완료

---

# 엑셀/CSV 파일 자동 프로세싱 프로그램 (GUI 버전)

## 개요
이 프로그램은 사용자가 엑셀(.xlsx) 또는 CSV(.csv) 파일을 GUI를 통해 쉽게 업로드하고, `pandas` 라이브러리로 자동 처리한 후, 결과를 미리 보고 새로운 파일로 다운로드할 수 있는 Python 스크립트입니다.

---

## 주요 기능 (GUI 통합)
1.  **직관적인 파일 업로드:**
    * `파일 선택` 버튼을 통해 엑셀 또는 CSV 파일을 쉽게 선택하고 업로드할 수 있는 전용 영역을 제공합니다.
2.  **헤더(열 이름) 공백 자동 제거:**
    * 모든 열 이름의 앞뒤 공백을 자동으로 제거합니다.
3.  **'sample' 관련 열 자동 처리:**
    * 'sample'이 포함된 열 중 첫 번째 열만 남기고 나머지는 자동 삭제합니다.
    * 남겨진 sample 열 이름은 자동으로 인식하여 Time 계산에 사용합니다.
4.  **Time 열 자동 추가:**
    * sample 열 값에 0.01을 곱한 값을 'Time'이라는 이름의 새 열로, DataFrame의 맨 앞에 추가합니다.
5.  **처리 결과 미리보기:**
    * 파일 처리 완료 후, 처리된 데이터의 처음 5행을 GUI 내 미리보기 영역에 즉시 표시합니다.
6.  **처리된 파일 다운로드:**
    * 처리된 데이터를 원하는 파일명으로 저장할 수 있도록 `파일 저장` 버튼과 다운로드 경로/파일명 선택 기능을 제공합니다. 기본값으로 원본 파일명 뒤에 `_processed`가 붙은 이름으로 제안합니다.

---

## 설치 방법

1.  Python 3.8 이상이 설치되어 있어야 합니다.
2.  필요한 패키지 설치:
    ```bash
    pip install pandas openpyxl
    ```
    * `pandas`: 데이터 처리의 핵심 라이브러리.
    * `openpyxl`: `pandas`가 `.xlsx` 파일을 읽고 쓰는 데 필요합니다.

---

## 사용법

1.  터미널(명령 프롬프트)에서 프로그램이 있는 폴더로 이동합니다.
2.  아래 명령어로 프로그램을 실행합니다:
    ```bash
    python excel_processor_gui.py
    ```
    *(스크립트 파일명을 `excel_processor_gui.py`로 가정합니다.)*
3.  GUI 창이 뜨면 다음 단계를 따릅니다:
    * **`파일 선택` 버튼 클릭:** 파일 탐색기가 열리면 처리할 엑셀 또는 CSV 파일을 선택합니다.
    * 파일이 로드되고 처리되면, `미리보기` 영역에 처리된 데이터의 처음 5행이 표시됩니다.
    * **`파일 저장` 버튼 클릭:** 파일 저장 대화 상자가 열리면, 처리된 데이터를 저장할 경로와 파일명을 입력하거나 기본 제안된 이름을 사용합니다.
4.  저장이 완료되면 완료 메시지가 표시됩니다.

---

## 예시 실행 화면 (개념적 GUI 흐름)

================================================== 엑셀 파일 프로세서
+------------------------------------------------+
| [ 파일 선택 ]          [ 선택된 파일: 없음 ] |
+------------------------------------------------+
|                                                |
|            [ 파일 미리보기 영역 ]              |
|   Time  sample 수   DOF1   DOF2               |
| 0 0.00    0          ...    ...               |
| 1 0.01    1          ...    ...               |
| 2 0.02    2          ...    ...               |
| 3 0.03    3          ...    ...               |
| 4 0.04    4          ...    ...               |
|                                                |
+------------------------------------------------+
| [ 파일 저장 ]                                  |
+------------------------------------------------+
| 상태: 파일을 선택해주세요.                     |
+------------------------------------------------+


**GUI 동작 흐름:**

1.  프로그램 실행 시 위와 같은 GUI 창이 나타납니다.
2.  사용자가 `파일 선택` 버튼을 클릭합니다.
3.  파일 탐색기 창이 열리고, 사용자가 `05.DOF_ANGLE_CONTROLL_P_d_dot.xlsx` 파일을 선택하고 `열기`를 클릭합니다.
4.  `선택된 파일:` 옆에 `05.DOF_ANGLE_CONTROLL_P_d_dot.xlsx`가 표시됩니다.
5.  파일이 자동으로 처리되고, `파일 미리보기 영역`에 다음과 같이 데이터의 처음 5행이 업데이트됩니다.
    ```
      Time  sample 수   DOF1   DOF2
    0 0.00          0    ...    ...
    1 0.01          1    ...    ...
    2 0.02          2    ...    ...
    3 0.03          3    ...    ...
    4 0.04          4    ...    ...
    ```
6.  `상태:` 메시지가 "파일 처리가 완료되었습니다."로 변경됩니다.
7.  사용자가 `파일 저장` 버튼을 클릭합니다.
8.  파일 저장 대화 상자가 열리고, 기본 파일명으로 `05.DOF_ANGLE_CONTROLL_P_d_dot_processed.xlsx`가 제안됩니다. 사용자가 경로를 선택하고 `저장`을 클릭합니다.
9.  `상태:` 메시지가 "파일이 성공적으로 저장되었습니다."로 변경됩니다.

---

## 입력/출력 파일 예시

### 입력 예시
| sample 수 | DOF1 | sample 1 | DOF2 | sample 2 | ... |
|-----------|------|----------|------|----------|-----|
| 0         | ...  | 0        | ...  | 0        | ... |
| 1         | ...  | 1        | ...  | 1        | ... |
| 2         | ...  | 2        | ...  | 2        | ... |

### 출력 예시
| Time  | sample 수 | DOF1 | DOF2 | ... |
|-------|-----------|------|------|-----|
| 0.00  | 0         | ...  | ...  | ... |
| 0.01  | 1         | ...  | ...  | ... |
| 0.02  | 2         | ...  | ...  | ... |

---

## 주의사항 및 팁
* 입력 파일은 반드시 첫 번째 행이 헤더여야 합니다.
* 'sample'을 포함하는 열이 최소 하나 이상 있어야 합니다.
* GUI가 응답하지 않는 것처럼 보이면, 파일 크기가 크거나 처리 시간이 오래 걸리는 경우일 수 있습니다. (향후 비동기 처리 또는 진행 바 추가 고려)
* 저장 경로에 쓰기 권한이 없는 경우, 오류가 발생할 수 있습니다.

---

## 오류 및 예외 처리
* 파일이 존재하지 않거나, 지원하지 않는 파일 형식인 경우, GUI 내 상태 메시지 또는 팝업 메시지로 오류가 출력됩니다.
* 'sample' 관련 열이 없으면 미리보기 영역에 경고 메시지가 출력될 수 있습니다.
* 저장 중 오류가 발생하면 오류 메시지가 출력됩니다.

---

## 샘플 데이터 생성 (테스트용)
테스트용 샘플 데이터를 만들고 싶다면 아래 스크립트를 실행하세요:
```bash
python create_sample_data.py
(create_sample_data.py 스크립트가 별도로 있다고 가정합니다.)

문의 및 개선 요청
추가 기능 요청, 버그 제보 등은 언제든 말씀해 주세요!